layui.define(["layer","jquery"],function(exports){function renderCssCode(obj){var content,k,code=html_tpl.css_tpl;obj=obj||{},content={iframe_theme_color:obj.iframe_theme_color||"#1b8fe5",iframe_text_color:obj.iframe_text_color||"white",iframe_text_hover_background:obj.iframe_text_hover_background||"#777",task_bar_project_color:obj.task_bar_project_color||"#cecece",task_bar_project_selected_color:obj.task_bar_project_selected_color||"white"};for(k in content)code=code.replace(eval("/{{"+k+"}}/g"),content[k]);0==$("#enian-iframe-css").length&&$("body").append('<div id="enian-iframe-css" class="layui-hide"><style>'+code+"</style></div>")}function iframeInit(a){var b=a.taskBtns||{};window_config.task_bar_btns.left=b.left,window_config.task_bar_btns.right=b.right,renderCssCode(a.cssConfig),open_task_bar_window(a)}function task_display(a){var b=$("#layui-layer"+window_config.task_bar_id);0==a?b.hasClass("layui-hide")||b.addClass("layui-hide"):1==a&&b.hasClass("layui-hide")&&b.removeClass("layui-hide")}function windows_list(){var c,a=window_config.item,b={item:[],info:{}};for(c=0;c<a.length;c++)a[c]&&(b["item"].push(c),b["info"][c]=a[c]);return b}function get_window_zIndex(a){var b=$("#layui-layer"+a).css("zIndex");return b}function set_top_window(a,b){var c,d;if(!b){for(c=windows_list(),d=0;d<c["item"].length;d++)$("#iframe-task-obj"+c["item"][d]).removeClass("iframe-window-top");$("#iframe-task-obj"+a).addClass("iframe-window-top")}window_config.zIndex++,$("#layui-layer"+a).css("zIndex",window_config.zIndex)}function open_task_bar_window(a){function b(a,b){var c=".iframe-task-content";$(c+" .iframe-task-btns ."+a).click(function(){b(a)})}1!=window_config["task_bar_exist"]&&layer.open({title:!1,type:1,skin:"iframe-task",move:".iframe-task-move",closeBtn:0,anim:2,shade:!1,area:["100%","35px"],resize:!1,zIndex:window_config.zIndex,offset:"b",content:html_tpl.taskBar(),success:function(c,d){var e,f,g,h;if(set_top_window(d),window_config["task_bar_id"]=d,e=window_config.task_bar_btns.left,f=window_config.task_bar_btns.right,a.taskBtnsClick){for(g in e)b(e[g][0],a.taskBtnsClick);for(g in f)b(f[g][0],a.taskBtnsClick)}$("#layui-layer"+d).click(function(){set_top_window(d,!0)}),h=40*(e.length+f.length+1),$(".iframe-task-item").css("width","calc(100% - "+h+"px)"),a.success&&a.success(c,d)}})}function add_task_bar_obj(a,b){var c='<div id="iframe-task-obj'+a+'" class="iframe-task-obj"><div class="layui-elip iframe-task-obj-text iframe-task-obj-text-selected" title="'+b+'">'+b+"</div></div>";$("#iframe-task-obj"+a),$(".iframe-task-content .iframe-task-item").append(c),$("#iframe-task-obj"+a).click(function(){set_top_window(a,!0),window_config["item"][a].display?window_min(a):(window_block(a),set_top_window(a))})}function task_move_btn_display(a){var b=$(".iframe-task-right-btns .iframe-task-move");0==a?b.hasClass("layui-hide")||b.addClass("layui-hide"):1==a&&b.hasClass("layui-hide")&&b.removeClass("layui-hide")}function del_task_bar_obj(a){$("#iframe-task-obj"+a).remove(),delete window_config["item"][a]}function set_window_size(a,b,c,d,e){var f="#layui-layer"+a+" ";$(f).css("top",b),$(f).css("left",c),$(f).css("height",d),$(f+".layui-layer-content").css("height","100%"),$(f).css("width",e)}function window_min(a,b){var c="#layui-layer"+a+" ";$(c).addClass("layui-hide"),window_config["item"][a].display=0,$("#iframe-task-obj"+a+" .iframe-task-obj-text").removeClass("iframe-task-obj-text-selected"),set_top_window(0),b&&b()}function window_block(a,b){$("#iframe-task-obj"+a+" .iframe-task-obj-text").addClass("iframe-task-obj-text-selected"),$("#layui-layer"+a).removeClass("layui-hide"),window_config["item"][a].display=1,b&&b()}function window_max(a){var b="#layui-layer"+a+" ";window_config["item"][a].height=$(b).height(),window_config["item"][a].width=$(b).width(),window_config["item"][a].top=$(b).position().top,window_config["item"][a].left=$(b).position().left,$(b+".iframe-bar-fangda-btn").addClass("layui-hide"),$(b+".iframe-bar-suoxiao-btn").removeClass("layui-hide"),$(b).hasClass("layui-hide")&&$(b).removeClass("layui-hide"),set_top_window(a),set_window_size(a,window_config.maxOffset[0],window_config.maxOffset[1],window_config.maxOffset[2],window_config.maxOffset[3])}function window_restore(a){var b="#layui-layer"+a+" ";$(b+".iframe-bar-suoxiao-btn").addClass("layui-hide"),$(b+".iframe-bar-fangda-btn").removeClass("layui-hide"),$(b).hasClass("layui-hide")&&$(b).removeClass("layui-hide"),set_window_size(a,window_config["item"][a].top,window_config["item"][a].left,window_config["item"][a].height,window_config["item"][a].width)}function window_close(a,b){layer.close(a),del_task_bar_obj(a),b&&b()}function openWindow(a){function i(b,c){set_top_window(c),a.btnClick&&a.btnClick(b,c)}function j(a,b){var c="#layui-layer"+b+" ";d&&d[0]&&$(c+" .iframe-bar ."+d[0]).click(function(){i(d[0],b)}),e&&e[0]&&$(c+" .iframe-bar ."+e[0]).click(function(){i(e[0],b)}),$("#layui-layer"+b+" .layui-layui-layer").click(function(){set_top_window(b)}),set_top_window(b)}var b=a.title,c=a.url,d=a.btn1,e=a.btn2,f=a.area||["600px","300px"],g=a.anim||2,h=0==a.moveOut?!1:!0;layer.open({title:!1,type:1,skin:"iframe-class",move:".iframe-bar-title",closeBtn:0,anim:g,shade:!1,area:f,zIndex:window_config.zIndex,moveOut:h,content:html_tpl.window(b,c,d,e),moveEnd:function(a){var b=a.attr("id"),c=b.substring(b.length-1);set_top_window(c)},success:function(c,d){window_config["item"][d]={},window_config["item"][d].display=1,window_config["item"][d].layero=c,add_task_bar_obj(d,b);var e="#layui-layer"+d+" ";$(e+".iframe-bar-zuixiao-btn").click(function(){window_min(d)}),$(e+".iframe-bar-fangda-btn").click(function(){window_max(d)}),$(e+".iframe-bar-suoxiao-btn").click(function(){window_restore(d)}),$(e+".iframe-bar-guanbi-btn").click(function(){window_close(d,function(){a.end&&a.end()})}),j(c,d),a.success&&a.success(c,d)}})}var layer=layui.layer,$=layui.jquery,window_config={task_bar_exist:0,task_bar_id:0,zIndex:9999,closeWinAndTask:!1,color:{theme:"#1b8fe5"},maxOffset:[0,0,"calc(100% - 35px)","100%"],item:[],task_bar_btns:{left:[],right:[]},click:function(){}},html_tpl={window:function(a,b,c,d){var c=c||[],d=d||[];return'<div class="iframe-bar"><div class="layui-inline layui-unselect iframe-float-left">'+(c[1]?'<div class="iframe-bar-kuang '+c[0]+'">'+c[1]+"</div>":"")+(d[1]?'<div class="iframe-bar-kuang '+d[0]+'">'+d[1]+"</div>":"")+"</div>"+'<div class="iframe-bar-title layui-inline layui-elip">'+a+"</div>"+'<div class="iframe-float-right  layui-inline layui-unselect">'+'<div class="iframe-bar-kuang iframe-bar-zuixiao-btn"><i class="iconfont icon-zuixiao"  title="最小化"></i></div>'+'<div class="iframe-bar-kuang iframe-bar-fangda-btn"><i class="iconfont icon-fangda"></i></div>'+'<div class="iframe-bar-kuang iframe-bar-suoxiao-btn layui-hide"><i class="iconfont icon-suoxiao"></i></div>'+'<div class="iframe-bar-kuang iframe-bar-guanbi-btn"><i class="iconfont icon-guanbi" title="关闭"></i></div>'+"</div>"+"</div>"+'<div style="height:calc(100% - 35px);background:white">'+'<iframe src="'+b+'" frameborder="0" width="100%" height="100%"></iframe>'+"</div>"},taskBar:function(){var e,a=window_config.task_bar_btns.left,b=window_config.task_bar_btns.right,c="",d="";for(e in a)c+='<div class="iframe-bar-kuang iframe-task-btns-item layui-inline '+a[e][0]+'">'+a[e][1]+"</div>";for(e in b)d+='<div class="iframe-bar-kuang iframe-task-btns-item layui-inline '+b[e][0]+'">'+b[e][1]+"</div>";return'<div class="iframe-task-content layui-unselect"><div class="layui-inline iframe-float-left iframe-task-btns">'+c+"</div>"+'<div class="layui-inline iframe-task-item">'+"</div>"+'<div class="layui-inline iframe-float-right iframe-task-right-btns iframe-task-btns">'+d+'<div class="iframe-task-btns-item layui-inline iframe-task-move"><i class="iframe-bar-btn-size iconfont icon-yidong "></i></div>'+"</div>"+"</div>"},css_tpl:".iframe-bar-btn-size{font-size:20px}.iframe-bar{height:36px;line-height:35px;background:{{iframe_theme_color}};color:{{iframe_text_color}}}.iframe-bar-kuang{display:inline-block;width:40px;height:35px;text-align:center}.iframe-bar-kuang:hover{background:{{iframe_text_hover_background}}}.iframe-task-btns-item{width:40px;height:35px;line-height:35px;text-align:center}.iframe-bar-title{width:calc(100% - 220px);margin-left:5px;float:left}.iframe-float-right{float:right}.iframe-float-left{float:left}.iframe-bar-guanbi-btn:hover{background:red}.iframe-class .layui-layer-content{border:1px solid {{iframe_theme_color}}}.iframe-task{box-shadow:none!important}.iframe-task .layui-layer-content{border:1px solid {{iframe_theme_color}};background:{{iframe_theme_color}};color:{{iframe_text_color}}}.iframe-task .layui-layer-content,body .iframe-class .layui-layer-content{overflow:hidden!important}.iframe-task-obj{line-height:35px;height:35px;width:150px;display:inline-block}.iframe-task-obj:hover{background:{{iframe_text_hover_background}}}.iframe-task-obj-text{margin-left:10px;margin-right:10px;color:{{task_bar_project_color}}}.iframe-task-obj-text-selected{color:{{task_bar_project_selected_color}}}.iframe-task-item{position:absolute;height:40px;width:500px;overflow:auto}.iframe-window-top{background:{{iframe_text_hover_background}}}"},entrance={open:openWindow,init:iframeInit,taskBarBtnMoveDisplay:task_move_btn_display,taskDisplay:task_display,windowsList:windows_list,setWindowSize:set_window_size,close:window_close,min:window_min,v:function(){return"0.1.19-4-30"}};exports("enianWindow",entrance)});